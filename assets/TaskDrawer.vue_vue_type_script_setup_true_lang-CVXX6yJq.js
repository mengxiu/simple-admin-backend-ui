var _=Object.defineProperty;var g=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var h=(e,s,t)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,w=(e,s)=>{for(var t in s||(s={}))S.call(s,t)&&h(e,t,s[t]);if(g)for(var t of g(s))T.call(s,t)&&h(e,t,s[t]);return e};var k=(e,s,t)=>new Promise((o,u)=>{var d=r=>{try{l(t.next(r))}catch(c){u(c)}},m=r=>{try{l(t.throw(r))}catch(c){u(c)}},l=r=>r.done?o(r.value):Promise.resolve(r.value).then(d,m);l((t=t.apply(e,s)).next())});import{b as v,c as D}from"./useForm-BzgFlAKs.js";import{a as p,b as G,as as R,v as C}from"./entry/index-BPNJPE-d-1727367563404.js";import{l as B,d as F,f as P,c as q,u as i,S as E,U as L,X as A,k as U,a0 as V}from"./vue-D0RdBkD6.js";import{Q as N}from"./antd-CnnxMtH0.js";import{a as $,B as j}from"./index-CaWdKrxn.js";const Y=(e,s="notice")=>p.post({url:"/sys-api/task/list",params:e},{errorMessageMode:s}),H=(e,s="notice")=>p.post({url:"/sys-api/task/create",params:e},{errorMessageMode:s,successMessageMode:s}),y=(e,s="notice")=>p.post({url:"/sys-api/task/update",params:e},{errorMessageMode:s,successMessageMode:s}),Z=(e,s="notice")=>p.post({url:"/sys-api/task/delete",params:e},{errorMessageMode:s,successMessageMode:s}),{t:a}=G(),ee=[{title:a("sys.task.name"),dataIndex:"name",width:100},{title:a("sys.task.taskGroup"),dataIndex:"taskGroup",width:50},{title:a("sys.task.cronExpression"),dataIndex:"cronExpression",width:100},{title:a("sys.task.pattern"),dataIndex:"pattern",width:60},{title:a("common.status"),dataIndex:"status",width:40,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),B(N,{checked:e.status===1,checkedChildren:a("common.on"),unCheckedChildren:a("common.off"),loading:e.pendingStatus,onChange(s,t){e.pendingStatus=!0;const o=s?1:2;y({id:e.id,status:o}).then(()=>{e.status=o}).finally(()=>{e.pendingStatus=!1})}}))},{title:a("common.createTime"),dataIndex:"createdAt",width:50,customRender:({record:e})=>R(e.createdAt)}],se=[{field:"name",label:a("sys.task.name"),component:"Input",colProps:{span:8},rules:[{max:50}]},{field:"taskGroup",label:a("sys.task.taskGroup"),component:"Input",colProps:{span:8},rules:[{max:40}]}],O=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:a("sys.task.name"),component:"Input",required:!0,rules:[{max:50}]},{field:"taskGroup",label:a("sys.task.taskGroup"),component:"Input",required:!0,rules:[{max:40}]},{field:"cronExpression",label:a("sys.task.cronExpression"),component:"Input",required:!0,rules:[{max:80}]},{field:"pattern",label:a("sys.task.pattern"),component:"Input",required:!0,rules:[{max:100}]},{field:"payload",label:a("sys.task.payload"),component:"Input",required:!0},{field:"status",label:a("sys.task.status"),component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:a("common.on"),value:1},{label:a("common.off"),value:2}]}}],te=F({__name:"TaskDrawer",emits:["success","register"],setup(e,{emit:s}){const t=s,o=P(!0),{t:u}=C.useI18n(),[d,{resetFields:m,setFieldsValue:l,validate:r}]=v({labelWidth:160,baseColProps:{span:24},layout:"vertical",schemas:O,showActionButtonGroup:!1}),[c,{setDrawerProps:f,closeDrawer:I}]=$(n=>k(this,null,function*(){yield m(),f({confirmLoading:!1}),o.value=!!(n!=null&&n.isUpdate),i(o)&&(yield l(w({},n.record)))})),x=q(()=>i(o)?u("sys.task.editTask"):u("sys.task.addTask"));function b(){return k(this,null,function*(){const n=yield r();f({confirmLoading:!0}),n.id=i(o)?Number(n.id):0,(i(o)?yield y(n):yield H(n)).code===0&&(I(),t("success")),f({confirmLoading:!1})})}return(n,M)=>(E(),L(i(j),V(n.$attrs,{onRegister:i(c),showFooter:"",title:x.value,width:"35%",onOk:b}),{default:A(()=>[U(i(D),{onRegister:i(d)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{te as _,ee as c,Z as d,Y as g,se as s};
