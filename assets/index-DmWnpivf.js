var m=(f,o,r)=>new Promise((c,l)=>{var g=t=>{try{d(r.next(t))}catch(u){l(u)}},b=t=>{try{d(r.throw(t))}catch(u){l(u)}},d=t=>t.done?c(t.value):Promise.resolve(t.value).then(g,b);d((r=r.apply(f,o)).next())});import{i as U}from"./index-D0CbPeO-.js";import{u as q,_ as E}from"./useTable-C1zHh-l8.js";import{b as V,a as W,c as A}from"./useForm-BzgFlAKs.js";import{b as G,v as H,aq as j}from"./entry/index-BPNJPE-d-1727367563404.js";import{u as X}from"./index-CaWdKrxn.js";import{g as Z,c as z,s as J,_ as K,d as k}from"./SmsProviderDrawer.vue_vue_type_script_setup_true_lang-4BlyWJ-B.js";import{_ as Q}from"./LogModal.vue_vue_type_script_setup_true_lang-JSU0Nr3b.js";import{b as Y,B as ee}from"./index-BoOgNZ_b.js";import{a as oe}from"./messageSender-BIFkj2gv.js";import{M as te}from"./antd-CnnxMtH0.js";import{d as ne,f as _,ae,S as C,a8 as se,k as s,X as i,U as I,u as e,G as S,ac as w,Z as P}from"./vue-D0RdBkD6.js";import"./ExclamationCircleOutlined-m2nOMvaL.js";import"./index-LAC3wiAG.js";import"./isBoolean-Dou3jA6I.js";import"./isNumber-j3SIk7av.js";import"./index-DDNUB-iW.js";import"./object-BY_VTB7H.js";import"./isDeepEqual-DIYWxe5x.js";import"./useWindowSizeFn-C71HDhub.js";import"./onMountedOrActivated-CyX9qi6i.js";import"./sortable.esm-BEDva30o.js";import"./index-DgmEQ_L6.js";import"./copyTextToClipboard-DU2l1C12.js";import"./useSortable-s3dauH_p.js";import"./index-BLETcaq3.js";import"./index-CBEN6l7B.js";import"./components-BezANJUq.js";const{t:a}=G(),re=[{field:"phoneNumber",label:a("mcms.sms.phoneNumber"),component:"Input",required:!0},{field:"params",label:a("mcms.sms.params"),component:"Input",required:!0,helpMessage(f){return a("mcms.sms.paramsHelp")}},{field:"templateId",label:a("mcms.sms.templateId"),component:"Input",helpMessage(f){return a("mcms.sms.templateIdHelp")}},{field:"signName",label:a("mcms.sms.signName"),component:"Input"},{field:"provider",label:a("mcms.emailLog.provider"),component:"Select",componentProps:{options:[{label:a("mcms.smsProvider.tencent"),value:"tencent"},{label:a("mcms.smsProvider.aliyun"),value:"aliyun"},{label:a("mcms.smsProvider.uni"),value:"uni"}]}}],Le=ne({name:"SmsProviderManagement",__name:"index",setup(f){const{t:o}=H.useI18n(),r=_(),c=_(!1),l=_(!1),[g,{openDrawer:b}]=X(),[d,{reload:t}]=q({title:o("mcms.smsProvider.smsProviderList"),api:Z,columns:z,formConfig:{labelWidth:120,schemas:J},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:o("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",columnWidth:20,onChange:(n,p)=>{r.value=n,c.value=n.length>0}}}),[u,{openModal:M}]=Y(),[x,{validate:B}]=V({labelWidth:160,labelAlign:"right",baseColProps:{span:18},layout:"vertical",schemas:re,showActionButtonGroup:!1});function R(n){M(!0,{record:n})}function D(){b(!0,{isUpdate:!1})}function N(n){b(!0,{record:n,isUpdate:!0})}function T(n){return m(this,null,function*(){(yield k({ids:[n.id]})).code===0&&(yield t())})}function F(){return m(this,null,function*(){te.confirm({title:o("common.deleteConfirm"),icon:s(U.ExclamationCircleOutlined),onOk(){return m(this,null,function*(){(yield k({ids:r.value})).code===0&&(c.value=!1,yield t())})},onCancel(){}})})}function L(){return m(this,null,function*(){yield t()})}function O(){l.value=!0}function $(){return m(this,null,function*(){const n=yield B();yield oe(n)})}return(n,p)=>{const y=ae("a-button");return C(),se("div",null,[s(e(E),{onRegister:e(d)},{tableTitle:i(()=>[c.value?(C(),I(e(j),{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:F},{default:i(()=>[S(w(e(o)("common.delete")),1)]),_:1})):P("",!0)]),toolbar:i(()=>[s(y,{type:"success",onClick:O},{default:i(()=>[S(w(e(o)("mcms.sms.sendSms")),1)]),_:1}),s(y,{type:"primary",onClick:D},{default:i(()=>[S(w(e(o)("mcms.smsProvider.addSmsProvider")),1)]),_:1})]),bodyCell:i(({column:h,record:v})=>[h.key==="action"?(C(),I(e(W),{key:0,actions:[{icon:"clarity:note-edit-line",onClick:N.bind(null,v)},{icon:"ic:round-library-books",tooltip:e(o)("common.viewLog"),onClick:R.bind(null,v)},{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e(o)("common.deleteConfirm"),placement:"left",confirm:T.bind(null,v)}}]},null,8,["actions"])):P("",!0)]),_:1},8,["onRegister"]),s(K,{onRegister:e(g),onSuccess:L},null,8,["onRegister"]),s(Q,{onRegister:e(u),defaultFullscreen:!0},null,8,["onRegister"]),s(e(ee),{open:l.value,"onUpdate:open":p[0]||(p[0]=h=>l.value=h),title:e(o)("mcms.sms.sendSms"),onOk:$},{default:i(()=>[s(e(A),{onRegister:e(x)},null,8,["onRegister"])]),_:1},8,["open","title"])])}}});export{Le as default};
