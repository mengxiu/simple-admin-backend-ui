var w=(b,c,d)=>new Promise((u,r)=>{var f=m=>{try{i(d.next(m))}catch(v){r(v)}},t=m=>{try{i(d.throw(m))}catch(v){r(v)}},i=m=>m.done?u(m.value):Promise.resolve(m.value).then(f,t);i((d=d.apply(b,c)).next())});import{d as q,r as y,c as T,ae as g,S as h,U as F,X as l,k as e,u as a,m as _,A as U,G as k,ac as A}from"./vue-D0RdBkD6.js";import{P as $}from"./index-CU2O72Tc.js";import{v as B,c as D,bq as N,br as V,bs as j}from"./entry/index-BPNJPE-d-1727367563404.js";import{h as G}from"./header-eUmriAJi.js";import{u as R}from"./cloudFile-BHp2dcVw.js";import{C as W}from"./index-BLETcaq3.js";import{o as X,U as z,a$ as E,d as x}from"./antd-CnnxMtH0.js";import"./useContentViewHeight-b3bBSljJ.js";import"./useWindowSizeFn-C71HDhub.js";import"./onMountedOrActivated-CyX9qi6i.js";import"./isNumber-j3SIk7av.js";import"./index-BoOgNZ_b.js";import"./index-LAC3wiAG.js";import"./isDeepEqual-DIYWxe5x.js";const ra=q({name:"Profile",__name:"index",setup(b){const c=X,d=z,u=E,{t:r}=B.useI18n(),f=D(),t=y({avatar:"",nickname:"",email:"",mobile:""}),i=y({oldPassword:"",newPassword:""});function m(){return w(this,null,function*(){const s=yield N();s.code===0&&(t.nickname=s.data.nickname,t.email=s.data.email,t.mobile=s.data.mobile,t.avatar=s.data.avatar)})}m();function v(){return w(this,null,function*(){const s=yield V({avatar:t.avatar,nickname:t.nickname,email:t.email,mobile:t.mobile});s.code===0&&x.success(s.msg,3)})}function C(){return w(this,null,function*(){const s=yield j({oldPassword:i.oldPassword,newPassword:i.newPassword});s.code===0&&x.success(s.msg,3)})}function I(s){const o=f.getUserInfo;o.avatar=s.data,t.avatar=s.data,f.setUserInfo(o)}const S=T(()=>{const{avatar:s}=f.getUserInfo;return s||G});return(s,o)=>{const p=g("a-input"),P=g("a-button");return h(),F(a($),null,{default:l(()=>[e(a(c),{title:a(r)("layout.header.profile"),style:{width:"100%"}},{default:l(()=>[e(a(d),{model:t,name:"basic","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",onSubmit:o[4]||(o[4]=n=>v())},{default:l(()=>[e(a(u),{label:a(r)("sys.user.avatar")},{default:l(()=>[e(a(W),{uploadApi:a(R),value:S.value,btnText:a(r)("sys.user.changeAvatar"),btnProps:{preIcon:"ant-design:cloud-upload-outlined"},onChange:I,width:"150"},null,8,["uploadApi","value","btnText"])]),_:1},8,["label"]),_(e(a(u),{name:"avatar"},{default:l(()=>[_(e(p,{value:t.avatar,"onUpdate:value":o[0]||(o[0]=n=>t.avatar=n)},null,8,["value"]),[[U,!1]])]),_:1},512),[[U,!1]]),e(a(u),{label:a(r)("sys.user.nickname"),name:"nickname",rules:[{required:!0}]},{default:l(()=>[e(p,{value:t.nickname,"onUpdate:value":o[1]||(o[1]=n=>t.nickname=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.login.mobile"),name:"mobile"},{default:l(()=>[e(p,{value:t.mobile,"onUpdate:value":o[2]||(o[2]=n=>t.mobile=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.login.email"),name:"email",rules:[{required:!0}]},{default:l(()=>[e(p,{value:t.email,"onUpdate:value":o[3]||(o[3]=n=>t.email=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{"wrapper-col":{offset:8,span:16}},{default:l(()=>[e(P,{type:"primary","html-type":"submit"},{default:l(()=>[k(A(a(r)("common.saveText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]),e(a(c),{title:a(r)("sys.user.changePassword"),style:{width:"100%"}},{default:l(()=>[e(a(d),{model:i,name:"basic","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",onSubmit:o[7]||(o[7]=n=>C())},{default:l(()=>[e(a(u),{label:a(r)("sys.user.oldPassword"),name:"oldPassword",rules:[{required:!0}]},{default:l(()=>[e(p,{type:"password",value:i.oldPassword,"onUpdate:value":o[5]||(o[5]=n=>i.oldPassword=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.user.newPassword"),name:"newPassword",rules:[{required:!0}]},{default:l(()=>[e(p,{type:"password",value:i.newPassword,"onUpdate:value":o[6]||(o[6]=n=>i.newPassword=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{"wrapper-col":{offset:8,span:16}},{default:l(()=>[e(P,{type:"primary","html-type":"submit"},{default:l(()=>[k(A(a(r)("common.saveText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})}}});export{ra as default};
