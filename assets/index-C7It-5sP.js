var d=(e,o,a)=>new Promise((i,m)=>{var c=t=>{try{r(a.next(t))}catch(s){m(s)}},u=t=>{try{r(a.throw(t))}catch(s){m(s)}},r=t=>t.done?i(t.value):Promise.resolve(t.value).then(c,u);r((a=a.apply(e,o)).next())});import{i as y}from"./index-D0CbPeO-.js";import{u as b,_ as S}from"./useTable-C1zHh-l8.js";import{a as T}from"./useForm-BzgFlAKs.js";import{b as v,as as h,v as D,aq as R}from"./entry/index-BPNJPE-d-1727367563404.js";import{u as U,g as B,d as g}from"./token-h4gRqmds.js";import{l as A,d as P,f as k,S as p,a8 as M,k as x,X as f,U as w,u as l,G as N,ac as V,Z as I}from"./vue-D0RdBkD6.js";import{Q as E,M as F}from"./antd-CnnxMtH0.js";import"./ExclamationCircleOutlined-m2nOMvaL.js";import"./index-LAC3wiAG.js";import"./isBoolean-Dou3jA6I.js";import"./index-BoOgNZ_b.js";import"./useWindowSizeFn-C71HDhub.js";import"./isDeepEqual-DIYWxe5x.js";import"./isNumber-j3SIk7av.js";import"./index-DDNUB-iW.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CyX9qi6i.js";import"./sortable.esm-BEDva30o.js";import"./index-DgmEQ_L6.js";import"./copyTextToClipboard-DU2l1C12.js";import"./useSortable-s3dauH_p.js";import"./index-BLETcaq3.js";import"./index-CBEN6l7B.js";const{t:n}=v(),L=[{title:"UUID",dataIndex:"id",width:80},{title:n("sys.login.username"),dataIndex:"username",width:50},{title:"Token",dataIndex:"token",width:50},{title:n("common.source"),dataIndex:"source",width:50},{title:n("common.status"),dataIndex:"status",width:40,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),A(E,{checked:e.status===1,checkedChildren:n("common.on"),unCheckedChildren:n("common.off"),loading:e.pendingStatus,onChange(o,a){e.pendingStatus=!0;const i=o?1:2;U({id:e.id,status:i}).then(()=>{e.status=i}).finally(()=>{e.pendingStatus=!1})}}))},{title:n("common.createTime"),dataIndex:"createdAt",width:50,customRender:({record:e})=>h(e.createdAt)},{title:n("common.expiredAt"),dataIndex:"expiredAt",width:50,customRender:({record:e})=>h(e.expiredAt)}],O=[{field:"UUID",label:"UUID",component:"Input",colProps:{span:8},rules:[{max:30}]},{field:"username",label:n("sys.login.username"),component:"Input",colProps:{span:8},rules:[{max:30}]},{field:"email",label:n("sys.login.email"),component:"Input",colProps:{span:8},rules:[{max:50}]},{field:"nickname",label:n("sys.user.nickname"),component:"Input",colProps:{span:8},rules:[{max:20}]}],de=P({name:"TokenManagement",__name:"index",setup(e){const{t:o}=D.useI18n(),a=k(),i=k(!1),[m,{reload:c}]=b({title:o("sys.token.tokenList"),api:B,columns:L,formConfig:{labelWidth:120,schemas:O},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:o("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",columnWidth:20,onChange:(t,s)=>{a.value=t,i.value=t.length>0}}});function u(t){return d(this,null,function*(){(yield g({ids:[t.id]})).code===0&&(yield c())})}function r(){return d(this,null,function*(){F.confirm({title:o("common.deleteConfirm"),icon:x(y.ExclamationCircleOutlined),onOk(){return d(this,null,function*(){(yield g({ids:a.value})).code===0&&(i.value=!1,yield c())})},onCancel(){}})})}return(t,s)=>(p(),M("div",null,[x(l(S),{onRegister:l(m)},{tableTitle:f(()=>[i.value?(p(),w(l(R),{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:r},{default:f(()=>[N(V(l(o)("common.delete")),1)]),_:1})):I("",!0)]),bodyCell:f(({column:C,record:_})=>[C.key==="action"?(p(),w(l(T),{key:0,actions:[{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:l(o)("common.deleteConfirm"),placement:"left",confirm:u.bind(null,_)}}]},null,8,["actions"])):I("",!0)]),_:1},8,["onRegister"])]))}});export{de as default};
