var p=(s,e,n)=>new Promise((c,i)=>{var d=o=>{try{l(n.next(o))}catch(m){i(m)}},g=o=>{try{l(n.throw(o))}catch(m){i(m)}},l=o=>o.done?c(o.value):Promise.resolve(o.value).then(d,g);l((n=n.apply(s,e)).next())});import{a as _,b as v}from"./ExclamationCircleOutlined-m2nOMvaL.js";import{b as w,as as x,a as S,v as T,aq as M,ar as k}from"./entry/index-BPNJPE-d-1727367563404.js";import{c as y}from"./components-BezANJUq.js";import{l as C,d as N,f as b,r as B,S as I,U as L,X as f,k as h,u as a,G as R,ac as D,Z as P,a0 as q}from"./vue-D0RdBkD6.js";import{a as O,B as V}from"./index-BoOgNZ_b.js";import{u as F,_ as A}from"./useTable-C1zHh-l8.js";import"./useForm-BzgFlAKs.js";import{M as H}from"./antd-CnnxMtH0.js";const{t}=w(),W=[{title:t("mcms.smsLog.phoneNumber"),dataIndex:"phoneNumber",width:50},{title:t("mcms.smsLog.content"),dataIndex:"content",width:50},{title:t("mcms.emailLog.sendStatus"),dataIndex:"sendStatus",width:20,customRender:({record:s})=>{let e;return s.sendStatus===1?e=t("common.successful"):e=t("common.failed"),C(y.Tag,{color:s.sendStatus===1?"green":"red"},e)}},{title:t("mcms.smsLog.provider"),dataIndex:"provider",width:30},{title:t("common.createTime"),dataIndex:"createdAt",width:40,customRender:({record:s})=>x(s.createdAt)}],$=[{field:"phoneNumber",label:t("mcms.smsLog.phoneNumber"),component:"Input",colProps:{span:8}},{field:"content",label:t("mcms.smsLog.content"),component:"Input",colProps:{span:8}},{field:"provider",label:t("mcms.smsLog.provider"),component:"Input",colProps:{span:8}},{field:"sendStatus",label:t("mcms.emailLog.sendStatus"),component:"Select",colProps:{span:8},defaultValue:0,componentProps:{options:[{label:t("common.all"),value:0},{label:t("common.successful"),value:1},{label:t("common.failed"),value:2}]}}];t("mcms.smsLog.phoneNumber"),t("mcms.smsLog.content"),t("mcms.smsLog.sendStatus"),t("mcms.smsLog.provider");const j=(s,e="notice")=>S.post({url:"/sys-api/sms_log/list",params:s},{errorMessageMode:e}),E=(s,e="notice")=>S.post({url:"/sys-api/sms_log/delete",params:s},{errorMessageMode:e,successMessageMode:e}),ee=N({__name:"LogModal",setup(s){const{t:e}=T.useI18n(),n=b(),c=b(!1),{notification:i}=k(),d=B({}),[g,{reload:l}]=F({title:e("sys.task.taskList"),api:j,columns:W,formConfig:{labelWidth:120,schemas:$},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,rowKey:"id",rowSelection:{type:"checkbox",columnWidth:20,onChange:(r,u)=>{n.value=r,c.value=r.length>0}}}),[o]=O(r=>p(this,null,function*(){d.taskId=r.record.id}));function m(){return p(this,null,function*(){H.confirm({title:e("common.deleteConfirm"),icon:h(v),onOk(){return p(this,null,function*(){const u=yield E({ids:n.value});u.code===0&&(c.value=!1,i.success({message:e("common.successful"),description:e(u.msg),duration:3}),yield l())})},onCancel(){}})})}return(r,u)=>(I(),L(a(V),q(r.$attrs,{title:a(e)("mcms.smsLog.smsLogList"),onRegister:a(o),wrapperFooterOffset:50,cancelText:a(e)("common.closeText"),showOkBtn:!1}),{default:f(()=>[h(a(A),{onRegister:a(g),searchInfo:d,class:"tableHeight"},{tableTitle:f(()=>[c.value?(I(),L(a(M),{key:0,type:"primary",danger:"",onClick:m},{icon:f(()=>[h(a(_))]),default:f(()=>[R(" "+D(a(e)("common.delete")),1)]),_:1})):P("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1},16,["title","onRegister","cancelText"]))}});export{ee as _};
