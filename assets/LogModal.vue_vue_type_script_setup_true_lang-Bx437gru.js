var f=(t,e,n)=>new Promise((l,u)=>{var d=s=>{try{c(n.next(s))}catch(i){u(i)}},p=s=>{try{c(n.throw(s))}catch(i){u(i)}},c=s=>s.done?l(s.value):Promise.resolve(s.value).then(d,p);c((n=n.apply(t,e)).next())});import{a as w,b as x}from"./ExclamationCircleOutlined-m2nOMvaL.js";import{b as M,as as k,a as b,v as I,aq as L,ar as v}from"./entry/index-BPNJPE-d-1727367563404.js";import{G as C,M as B}from"./antd-CnnxMtH0.js";import{l as R,d as S,f as _,r as A,S as y,U as T,X as g,k as h,u as a,G as D,ac as O,Z as V,a0 as F}from"./vue-D0RdBkD6.js";import{a as N,B as P}from"./index-BoOgNZ_b.js";import{u as G,_ as H}from"./useTable-C1zHh-l8.js";import"./useForm-BzgFlAKs.js";const{t:o}=M(),W=[{title:o("sys.taskLog.startedAt"),dataIndex:"startedAt",width:50,customRender:({record:t})=>k(t.startedAt)},{title:o("sys.taskLog.finishedAt"),dataIndex:"finishedAt",width:50,customRender:({record:t})=>k(t.finishedAt)},{title:o("sys.taskLog.result"),dataIndex:"result",width:30,customRender:({record:t})=>{let e;return t.result===1?e=o("common.successful"):e=o("common.failed"),R(C,{color:t.result===1?"green":"red"},e)}}],$=[{field:"result",label:o("sys.taskLog.result"),component:"Select",colProps:{span:8},defaultValue:0,componentProps:{options:[{label:o("common.all"),value:0},{label:o("common.successful"),value:1},{label:o("common.failed"),value:2}]}}],j=(t,e="notice")=>b.post({url:"/sys-api/task_log/list",params:t},{errorMessageMode:e}),q=(t,e="notice")=>b.post({url:"/sys-api/task_log/delete",params:t},{errorMessageMode:e,successMessageMode:e}),Y=S({__name:"LogModal",setup(t){const{t:e}=I.useI18n(),n=_(),l=_(!1),{notification:u}=v(),d=A({}),[p,{reload:c}]=G({title:e("sys.task.taskList"),api:j,columns:W,formConfig:{labelWidth:120,schemas:$},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,rowKey:"id",rowSelection:{type:"checkbox",columnWidth:20,onChange:(r,m)=>{n.value=r,l.value=r.length>0}}}),[s]=N(r=>f(this,null,function*(){d.taskId=r.record.id}));function i(){return f(this,null,function*(){B.confirm({title:e("common.deleteConfirm"),icon:h(x),onOk(){return f(this,null,function*(){const m=yield q({ids:n.value});m.code===0&&(l.value=!1,u.success({message:e("common.successful"),description:e(m.msg),duration:3}),yield c())})},onCancel(){}})})}return(r,m)=>(y(),T(a(P),F(r.$attrs,{title:a(e)("sys.taskLog.taskLogList"),onRegister:a(s),wrapperFooterOffset:50,cancelText:a(e)("common.closeText"),showOkBtn:!1}),{default:g(()=>[h(a(H),{onRegister:a(p),searchInfo:d,class:"tableHeight"},{tableTitle:g(()=>[l.value?(y(),T(a(L),{key:0,type:"primary",danger:"",onClick:i},{icon:g(()=>[h(a(w))]),default:g(()=>[D(" "+O(a(e)("common.delete")),1)]),_:1})):V("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1},16,["title","onRegister","cancelText"]))}});export{Y as _};
