var p=(s,e,n)=>new Promise((c,m)=>{var d=a=>{try{r(n.next(a))}catch(i){m(i)}},g=a=>{try{r(n.throw(a))}catch(i){m(i)}},r=a=>a.done?c(a.value):Promise.resolve(a.value).then(d,g);r((n=n.apply(s,e)).next())});import{a as L,b as x}from"./ExclamationCircleOutlined-m2nOMvaL.js";import{b as v,as as S,a as w,v as T,aq as M,ar as k}from"./entry/index-BPNJPE-d-1727367563404.js";import{c as y}from"./components-BezANJUq.js";import{l as C,d as B,f as b,r as R,S as I,U as _,X as f,k as h,u as o,G as P,ac as j,Z as D,a0 as O}from"./vue-D0RdBkD6.js";import{a as V,B as E}from"./index-BoOgNZ_b.js";import{u as F,_ as N}from"./useTable-C1zHh-l8.js";import"./useForm-BzgFlAKs.js";import{M as A}from"./antd-CnnxMtH0.js";const{t}=v(),H=[{title:t("mcms.emailLog.target"),dataIndex:"target",width:50},{title:t("mcms.emailLog.subject"),dataIndex:"subject",width:30},{title:t("mcms.emailLog.content"),dataIndex:"content",width:100},{title:t("mcms.emailLog.sendStatus"),dataIndex:"sendStatus",width:30,customRender:({record:s})=>{let e;return s.sendStatus===1?e=t("common.successful"):e=t("common.failed"),C(y.Tag,{color:s.sendStatus===1?"green":"red"},e)}},{title:t("mcms.emailLog.provider"),dataIndex:"provider",width:30},{title:t("common.createTime"),dataIndex:"createdAt",width:40,customRender:({record:s})=>S(s.createdAt)}],W=[{field:"target",label:t("mcms.emailLog.target"),component:"Input",colProps:{span:8}},{field:"subject",label:t("mcms.emailLog.subject"),component:"Input",colProps:{span:8}},{field:"provider",label:t("mcms.emailLog.provider"),component:"Input",colProps:{span:8}},{field:"sendStatus",label:t("mcms.emailLog.sendStatus"),component:"Select",colProps:{span:8},defaultValue:0,componentProps:{options:[{label:t("common.all"),value:0},{label:t("common.successful"),value:1},{label:t("common.failed"),value:2}]}}],$=(s,e="notice")=>w.post({url:"/sys-api/email_log/list",params:s},{errorMessageMode:e}),q=(s,e="notice")=>w.post({url:"/sys-api/email_log/delete",params:s},{errorMessageMode:e,successMessageMode:e}),ee=B({__name:"LogModal",setup(s){const{t:e}=T.useI18n(),n=b(),c=b(!1),{notification:m}=k(),d=R({}),[g,{reload:r}]=F({title:e("sys.task.taskList"),api:$,columns:H,formConfig:{labelWidth:120,schemas:W},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,rowKey:"id",rowSelection:{type:"checkbox",columnWidth:20,onChange:(l,u)=>{n.value=l,c.value=l.length>0}}}),[a]=V(l=>p(this,null,function*(){d.taskId=l.record.id}));function i(){return p(this,null,function*(){A.confirm({title:e("common.deleteConfirm"),icon:h(x),onOk(){return p(this,null,function*(){const u=yield q({ids:n.value});u.code===0&&(c.value=!1,m.success({message:e("common.successful"),description:e(u.msg),duration:3}),yield r())})},onCancel(){}})})}return(l,u)=>(I(),_(o(E),O(l.$attrs,{title:o(e)("mcms.emailLog.emailLogList"),onRegister:o(a),wrapperFooterOffset:50,cancelText:o(e)("common.closeText"),showOkBtn:!1}),{default:f(()=>[h(o(N),{onRegister:o(g),searchInfo:d,class:"tableHeight"},{tableTitle:f(()=>[c.value?(I(),_(o(M),{key:0,type:"primary",danger:"",onClick:i},{icon:f(()=>[h(o(L))]),default:f(()=>[P(" "+j(o(e)("common.delete")),1)]),_:1})):D("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1},16,["title","onRegister","cancelText"]))}});export{ee as _};
