var y=Object.defineProperty;var g=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var F=(l,a,t)=>a in l?y(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,b=(l,a)=>{for(var t in a||(a={}))z.call(a,t)&&F(l,t,a[t]);if(g)for(var t of g(a))C.call(a,t)&&F(l,t,a[t]);return l};var c=(l,a,t)=>new Promise((s,r)=>{var u=o=>{try{d(t.next(o))}catch(m){r(m)}},f=o=>{try{d(t.throw(o))}catch(m){r(m)}},d=o=>o.done?s(o.value):Promise.resolve(o.value).then(u,f);d((t=t.apply(l,a)).next())});import{b as _,c as x}from"./useForm-BzgFlAKs.js";import{b as R,as as B,v as D}from"./entry/index-BPNJPE-d-1727367563404.js";import{a as h,c as k}from"./cloudFile-BHp2dcVw.js";import{g as v}from"./storageProvider-CFOQ3JK-.js";import{g as I}from"./cloudFileTag-Df3Nxs6P.js";import{l as A,d as q,f as L,c as V,u as n,S as G,U as M,X as U,k as N,a0 as $}from"./vue-D0RdBkD6.js";import{Q as j}from"./antd-CnnxMtH0.js";import{a as K,B as O}from"./index-CaWdKrxn.js";const{t:e}=R(),te=[{title:e("fms.cloudFile.name"),dataIndex:"name",width:50},{title:e("fms.cloudFile.size"),dataIndex:"size",width:30,customRender:({record:l})=>l.size>1073741824?(l.size/1073741824).toFixed(2)+"GB":l.size>1048576?(l.size/1048576).toFixed(2)+"MB":(l.size/1024).toFixed(2)+"KB"},{title:e("fms.cloudFile.fileType"),dataIndex:"fileType",width:20,customRender:({record:l})=>l.fileType===3?e("fms.file.video"):l.fileType===4?e("fms.file.audio"):l.fileType===2?e("fms.file.image"):e("fms.file.other")},{title:e("common.status"),dataIndex:"state",width:20,customRender:({record:l})=>(Reflect.has(l,"pendingStatus")||(l.pendingStatus=!1),A(j,{checked:l.state===!0,checkedChildren:e("common.on"),unCheckedChildren:e("common.off"),loading:l.pendingStatus,onChange(a,t){l.pendingStatus=!0;const s=!!a;h({id:l.id,state:s}).then(()=>{l.state=s}).finally(()=>{l.pendingStatus=!1})}}))},{title:e("common.createTime"),dataIndex:"createdAt",width:30,customRender:({record:l})=>B(l.createdAt)}],ae=[{field:"name",label:e("fms.cloudFile.name"),component:"Input",colProps:{span:8}},{field:"providerId",label:e("fms.cloudFile.providerId"),component:"ApiSelect",componentProps:{api:v,params:{page:1,pageSize:1e3},resultField:"data.data",labelField:"name",valueField:"id"},colProps:{span:8}},{field:"tagIds",label:e("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:I,params:{page:1,pageSize:1e3,name:""},resultField:"data.data",labelField:"name",valueField:"id"},colProps:{span:8}},{field:"fileType",label:e("fms.file.fileType"),colProps:{span:8},component:"Select",defaultValue:0,componentProps:{options:[{label:e("common.all"),value:0},{label:e("fms.file.other"),value:1},{label:e("fms.file.image"),value:2},{label:e("fms.file.video"),value:3},{label:e("fms.file.audio"),value:4}]}}],Q=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:e("fms.cloudFile.name"),component:"Input",required:!0},{field:"url",label:e("fms.cloudFile.url"),component:"Input",required:!0},{field:"size",label:e("fms.cloudFile.size"),component:"InputNumber",required:!0},{field:"fileType",label:e("fms.cloudFile.fileType"),component:"Select",required:!0,componentProps:{options:[{label:e("fms.file.other"),value:1},{label:e("fms.file.image"),value:2},{label:e("fms.file.video"),value:3},{label:e("fms.file.audio"),value:4}]}},{field:"userId",label:e("fms.cloudFile.userId"),component:"Input",required:!0},{field:"providerId",label:e("fms.cloudFile.providerId"),component:"ApiSelect",required:!0,componentProps:{api:v,params:{page:1,pageSize:1e3},resultField:"data.data",labelField:"name",valueField:"id"}},{field:"tagIds",label:e("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:I,params:{page:1,pageSize:1e3,name:""},resultField:"data.data",labelField:"name",valueField:"id"}},{field:"state",label:e("fms.cloudFile.state"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:e("common.on"),value:!0},{label:e("common.off"),value:!1}]}}],ie=q({__name:"CloudFileDrawer",emits:["success","register"],setup(l,{emit:a}){const t=a,s=L(!0),{t:r}=D.useI18n(),[u,{resetFields:f,setFieldsValue:d,validate:o}]=_({labelWidth:160,baseColProps:{span:24},layout:"vertical",schemas:Q,showActionButtonGroup:!1}),[m,{setDrawerProps:p,closeDrawer:w}]=K(i=>c(this,null,function*(){yield f(),p({confirmLoading:!1}),s.value=!!(i!=null&&i.isUpdate),n(s)&&(yield d(b({},i.record)))})),S=V(()=>n(s)?r("fms.cloudFile.editCloudFile"):r("fms.cloudFile.addCloudFile"));function P(){return c(this,null,function*(){const i=yield o();p({confirmLoading:!0}),i.id=n(s)?i.id:"",(n(s)?yield h(i):yield k(i)).code===0&&(w(),t("success")),p({confirmLoading:!1})})}return(i,T)=>(G(),M(n(O),$(i.$attrs,{onRegister:n(m),showFooter:"",title:S.value,width:"35%",onOk:P}),{default:U(()=>[N(n(x),{onRegister:n(u)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{ie as _,te as c,ae as s};
